<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                                   "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Mapping file autogenerated by MyEclipse - Hibernate Tools -->
<hibernate-mapping>

	<!-- ########################################################## 
	## Consulta	de ELEPARAMETRO por codigo
	############################################################ -->
	<sql-query name="asociado.eleparametro">
		<return-scalar column="CODIGO" type="java.lang.Long" />
		<return-scalar column="TIP_COD" type="java.lang.Long" />
		<return-scalar column="NOMBRE" type="java.lang.String" />
		<return-scalar column="ESTADO" type="java.lang.String" />
		<return-scalar column="VALOR" type="java.lang.Long" />
		<![CDATA[
		SELECT P.CODIGO CODIGO,P.NOMBRE NOMBRE,P.ESTADO ESTADO, P.VALOR VALOR,P.TIP_COD  TIP_COD 
		FROM ELECDB.ELE_PARAMETRO P WHERE P.CODIGO=?
		]]>
	</sql-query>

	<!-- ##################################################### 
	##### Consulta de información basica de un Asociado   ####
	######################################################*-->
	<sql-query name="asociado.find">
		<return-scalar column="NITCLI" type="java.lang.String" />
		<return-scalar column="NOMCLI" type="java.lang.String" />
		<return-scalar column="NOMTIT" type="java.lang.String" />
		<return-scalar column="FECCON" type="java.lang.String" />
		<return-scalar column="FECING" type="java.lang.String" />
		<return-scalar column="AGCVIN" type="java.lang.String" />
		<return-scalar column="EMAIL" type="java.lang.String" />
		<![CDATA[
		SELECT a.nitcli NITCLI, trim(a.nomcl1) NOMCLI, a.feccon FECCON, a.fecing FECING,trim(b.nomtit) NOMTIT, 
        trim(db2util.getdir(dec(a.nitcli),char('DIN')))EMAIL,
        CASE a.codcii WHEN ? THEN trim(DB2UTIL.GETZONA(a.AGCVIN)) ELSE trim(DB2UTIL.GETZONA(a.AGCVIN))END AGCVIN
		FROM ELECDB.eleasomul a LEFT OUTER JOIN MULCLIDAT.clitit b ON A.NUMINT = B.NUMINT
		WHERE a.asocia = ? AND a.nitcli = ? AND a.estaso >=? AND a.estaso <=? AND a.tipcli = ?
		]]>
	</sql-query>

	<!-- ###################################################################################### 
		## 2. Javier Londoño - Premize SAS - 2012-11-01 ## ## Consulta los asociados 
			activos cuya fecha de ingreso es mayor a determinada ## ## fecha. 
		## ###################################################################################### -->
	<sql-query
		name="asociados.fecha.ingreso.superior.determinada.fecha">

		<return-scalar column="numint" type="java.lang.Long" />
		<![CDATA[
			SELECT CL.NUMINT FROM ELECDB.ELEASOMUL CL WHERE CL.FECING > :fecha6MesesAntesVotacion
			AND CL.ASOCIA = 1 AND CL.ESTASO = 10						
		]]>
	</sql-query>

	<!-- ###################################################################################### 
		## 3. Javier Londoño - Premize SAS - 2012-11-22 ## ## Consulta si hay un 
		asociado registrado en la cooperativa con la cédula pasada ## ## como parámetro 
		## ###################################################################################### -->
	<sql-query name="consulta.si.es.asociado">
		<return-scalar column="NUMINT" type="java.lang.Long" />
		<![CDATA[
			SELECT CL.NUMINT FROM ELECDB.ELEASOMUL CL WHERE CL.NITCLI = :nitcli AND CL.ASOCIA = 1									
		]]>
	</sql-query>


	<!-- ###################################################################################### 
		## 4. Javier Londoño - Premize SAS - 2012-11-27 ## ## Consulta el nombre 
		completo del asociado en el buc 
		## ###################################################################################### -->
	<sql-query name="consultar.nombre.asociado.buc">
		<return-scalar column="numInt" type="java.lang.Long" />
		<return-scalar column="nitCli" type="java.lang.Long" />
		<return-scalar column="nomCli" type="java.lang.String" />
		<return-scalar column="nomCl1" type="java.lang.String" />
		<![CDATA[
		SELECT NUMINT numInt, NITCLI nitCli, NOMCLI nomCli, NOMCL1 nomCl1
		FROM ELECDB.ELEASOMUL WHERE	NITCLI = :nitcli
	]]>
	</sql-query>

	<!-- ###################################################################################### 
		## Consulta datos zonas y regional del asociado en el buc 
		## ###################################################################################### -->
	<sql-query name="consultar.nombre.zona.asociado.buc">
		<return-scalar column="numInt" type="java.lang.Long" />
		<return-scalar column="nitCli" type="java.lang.Long" />
		<return-scalar column="nomCli" type="java.lang.String" />
		<return-scalar column="nomCl1" type="java.lang.String" />
		<return-scalar column="zonaElectoral"
			type="java.lang.String" />
		<return-scalar column="regional" type="java.lang.String" />
		<![CDATA[
		SELECT 	NUMINT numInt, NITCLI nitCli, NOMCLI nomCli, NOMCL1 nomCl1, CONCAT(ZE.CODIGO_ZONA_ELE,
		CONCAT('-',ZE.DESCRIPCION_ZONA_ELE)) zonaElectoral,
		(SELECT DISTINCT CONCAT(AG.CODREG,CONCAT('-',CT.CODNOM)) 
			FROM SEGURIDAD.PLTAGCORI AG, MULCLIDAT.CLITAB RG, MULCLIDAT.CLITAB ZN, ELECDB.ELE_ZONA_ELECTORAL ZE, ELECDB.ELE_ZONA ZI,MULCLIDAT.CLITAB CT
			WHERE ZN.CODTAB = 908 AND RG.CODTAB = 907 AND ZN.CODINT = AG.CODZON AND ZI.CODIGO_ZONA = AG.CODZON
			AND ZE.CODIGO_ZONA_ELE = ZI.CODIGO_ZONA_ELE AND CT.CODTAB = 608 AND CT.CODINT <> 0 AND CT.CODINT =AG.CODREG 
			AND ZI.CODIGO_ZONA_ELE=(SELECT ZE.CODIGO_ZONA_ELE FROM ELECDB.ELE_ASOCIADO A INNER JOIN ELECDB.ELE_ZONA Z ON A.COD_ZONA_ASO=Z.CODIGO_ZONA 
			INNER JOIN ELECDB.ELE_ZONA_ELECTORAL ZE ON Z.CODIGO_ZONA_ELE=ZE.CODIGO_ZONA_ELE
			WHERE A.NUMERO_DOCUMENTO=C.nitcli)) regional
		FROM 	ELECDB.ELEASOMUL C INNER JOIN ELECDB.ELEASOCIA A ON A.NUMERO_DOCUMENTO=C.nitcli
		INNER JOIN ELECDB.ELE_ZONA Z ON Z.CODIGO_ZONA=A.COD_ZONA_ASO
		INNER JOIN ELECDB.ELE_ZONA_ELECTORAL ZE ON ZE.CODIGO_ZONA_ELE = Z.CODIGO_ZONA_ELE
		WHERE	NITCLI = :nitcli
	]]>
	</sql-query>

	<!-- ###################################################################################### 
		## 5. Javier Londoño - Premize SAS - 2012-11-27 ## ## Consulta la informacion del asociado 
		###################################################################################### -->
	<sql-query name="consultar.info.asociado">
		<return-scalar column="numInt" type="java.lang.String" />
		<return-scalar column="nitCli" type="java.lang.String" />
		<return-scalar column="nomCli" type="java.lang.String" />
		<return-scalar column="nomCl1" type="java.lang.String" />
		<return-scalar column="lugarExpedicion"
			type="java.lang.String" />
		<return-scalar column="fechaExpedicion"
			type="java.lang.String" />
		<return-scalar column="desc_ciu_res"
			type="java.lang.String" />
		<return-scalar column="cod_zona" type="java.lang.String" />
		<return-scalar column="descrip_zona"
			type="java.lang.String" />
		<![CDATA[
		SELECT
			CL.NUMINT numInt, CL.NITCLI nitCli, CL.NOMCLI nomCli, CL.NOMCL1 nomCl1,
			CL.LUGEXP lugarExpedicion, CL.FECESC fechaExpedicion,
			DB2UTIL.SIP_CIUDAD(CL.NUMINT,char('RE')) desc_ciu_res,
			EZ.CODIGO_ZONA cod_zona, EZ.DESCRIPCION_ZONA descrip_zona
		FROM ELECDB.ELEASOMUL CL, ELECDB.ELEASOCIA EA, ELECDB.ELE_ZONA EZ		
		WHERE nitcli = :nitcli AND CL.NUMINT = EA.CODIGO_ASOCIADO AND EA.COD_ZONA_ASO = EZ.CODIGO_ZONA		
		]]>
	</sql-query>


	<!-- ###################################################################################### 
		## 6. Javier Londoño - Premize SAS - 2012-12-21 ## ## Consulta la fecha de 
		obtención del título del asociado en el BUC 
		## ###################################################################################### -->
	<sql-query name="consultar.fecha.obtencion.titulo.asociado">
		<return-scalar column="fecha" type="java.lang.Long" />
		<![CDATA[
		SELECT b.fecha
		FROM ELECDB.eleasomul a LEFT OUTER JOIN MULCLIDAT.clitit b ON A.NUMINT = B.NUMINT
		WHERE a.asocia = :asocia AND a.nitcli = :nitcli AND a.tipcli = :tipCli AND b.INDREG = 'AS'
	]]>
	</sql-query>
	

	<!-- ###################################################################################### 
		## 7. Carlos Ernesto Ortega Q - Contratista Coomeva - 2014-01-13 ## ## Consulta 
		si un asociado es persona jurídica 
		## ###################################################################################### -->
	<sql-query name="consulta.si.es.asociado.persona.juridica">
		<return-scalar column="NUMINT" type="java.lang.Long" />
		<![CDATA[
			SELECT CL.NUMINT FROM ELECDB.ELEASOMUL CL WHERE CL.NITCLI = :nitcli AND CL.TIPCLI = 1
		]]>
	</sql-query>


</hibernate-mapping>
